global.paginatePage = 1;

var Pagination = {
	total: '',
	limit: '',
	pages: '',
	page: '',
	offset: '',
	start: '',
	end: '',
	prevlink: '',
	nextlink: '',
	paginate: function (total, limit){
		// Find out how many items are in the table
		this.total = total;

		// How many items to list per page
		if ( typeof limit === "undefined") this.limit = total;
		this.limit = limit;

		// How many pages will there be
		this.pages = Math.ceil( this.total / this.limit );

		// What page are we currently on?
		this.page = Math.min(this.pages, paginatePage);

		// Calculate the offset for the query
		this.offset = (this.page - 1) * this.limit && (this.page - 1) * this.limit > 0 ? (this.page - 1) * this.limit : 0;

		return "LIMIT "+ this.limit +" OFFSET "+ this.offset;
	},

	getLinks: function (){
		// Some information to display to the user
		this.start = this.offset + 1;
		this.end = Math.min((this.offset + this.limit), this.total);

		obj = {};
		obj.page 		= this.page;
		obj.pages 		= this.pages;
		obj.start 		= this.start;
		obj.end 		= this.end;
		obj.total 		= this.total;
		return obj;
	},

	firstLink: function(name){
		global.paginatePage = 1;
		redirect(name);
	},
	lastLink: function(name){
		global.paginatePage = this.pages;
		redirect(name);
	},
	nextLink: function(name){
		global.paginatePage = this.page +1;
		redirect(name);
	},
	prevLink: function(name){
		global.paginatePage = this.page -1;
		redirect(name);
	}
}
module.exports = Pagination;
